<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ficha RPG - Candela Obscura</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="fichas-manager.css" />
  <script type="module" src="./script.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cormorant+Unicase:wght@300;400;500;600;700&family=Jim+Nightshade&display=swap');
  </style>


  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
    import { getFirestore } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";
    import { firebaseConfig } from "./firebase-config.js";
    // Inicializa Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    onAuthStateChanged(auth, user => {
      if (!user) {
        // Se não estiver logado, redireciona para login
        window.location.href = 'login.html';
      }
    });

    // Botão Logout
    const logoutBtn = document.getElementById('logoutBtn');
    logoutBtn.addEventListener('click', async () => {
      await signOut(auth);
      window.location.href = 'login.html';
    });

    const db = getFirestore(app);
    // Exporta para usar em outros scripts
    window.firebaseApp = app;
    window.firebaseAuth = auth;
    window.firebaseDB = db;
  </script>

</head>

<body>
  <main class="ficha">
    <!-- Cabeçalho -->
    <header class="ficha-header">
      <div class="logo">CANDELA OBSCURA</div>
      <div class="header-buttons">
        <!-- Simulador de Dados -->
        <button id="btnSimuladorDados" class="btn-simulador">Dados ▼</button>
        <div id="menuSimuladorDados" class="menu-simulador" style="display:none;">
          <button data-lados="4">D4</button>
          <button data-lados="6">D6</button>
          <button data-lados="8">D8</button>
          <button data-lados="12">D12</button>
          <button data-lados="20">D20</button>
          <button data-lados="100">D100</button>
        </div>
        <!-- Botão Logout -->
        <button id="logoutBtn" class="btn-logout">Logout</button>
      </div>
      
      <section id="fichasManager" class="fichas-manager">
        <h2>Minhas Fichas</h2>
        <ul id="listaFichas" class="lista-fichas">
          <!-- Lista de fichas será preenchida dinamicamente -->
        </ul>
        <button id="btnNovaFicha" class="btn-nova-ficha">+ Nova Ficha</button>
      </section>

      <form id="fichaForm">
        <div class="dados-gerais">
          <label>Nome: <input type="text" name="nome" /></label>
          <label>Papel: <input type="text" name="papel" /></label>
          <label>Espec: <input type="text" name="espec" /></label>
          <label>Círculo: <input type="text" name="circulo" /></label>
          <label>Plano: <input type="text" name="plano" /></label>
          <label>Religião: <input type="text" name="religiao" /></label>
        </div>

        <!-- Corpo, Astúcia, Intuição -->
        <section class="atributos">
          <div class="atributo" id="corpo">
            <h2>Corpo</h2>
            <label><input type="checkbox" class="mover-checkbox"> Mover <small>(Correr, Desviar, Guiar)</small>
              <br>
              <input type="checkbox"> <input type="checkbox"> <input type="checkbox"> <input type="checkbox"> <input
                type="checkbox"> <input type="checkbox"> <input type="checkbox">
              <!-- <input type="number" name="mover" min="0" max="6" /> -->
            </label>
            <label><input type="checkbox"> Atacar <small>(Socar, Quebrar, Derrubar)</small>
              <br>
              <input type="checkbox"> <input type="checkbox"> <input type="checkbox"> <input type="checkbox"> <input
                type="checkbox"> <input type="checkbox"> <input type="checkbox">
              <!-- <input type="number" name="atacar" min="0" max="6" /> -->
            </label>
            <label><input type="checkbox"> Controlar <small>(Dirigir, Atirar, Finesse)</small>
              <br>
              <input type="checkbox"> <input type="checkbox"> <input type="checkbox"> <input type="checkbox"> <input
                type="checkbox"> <input type="checkbox"> <input type="checkbox">
              <!-- <input type="number" name="controlar" min="0" max="6" /> -->
            </label>
          </div>
          <div class="atributo" id="astucia">
            <h2>Astúcia</h2>
            <label><input type="checkbox"> Investigar <small>(Pesquisar, Rastrear, Localizar)</small></label>
            <input type="checkbox"> <input type="checkbox"> <input type="checkbox"> <input type="checkbox"> <input
              type="checkbox"> <input type="checkbox"> <input type="checkbox">
            <!-- <input type="number" name="investigar" min="0" max="6" /> -->
            </label>
            <label><input type="checkbox"> Ler <small>(Linguagem Corporal, Identificar Mentiras)</small>
              <br>
              <input type="checkbox"> <input type="checkbox"> <input type="checkbox"> <input type="checkbox"> <input
                type="checkbox"> <input type="checkbox"> <input type="checkbox">
              <!-- <input type="number" name="ler" min="0" max="6" /> -->
            </label>
            <label><input type="checkbox"> Esconder <small>(Esgueirar-se, Disfarçar, Enganar)</small>
              <br>
              <input type="checkbox"> <input type="checkbox"> <input type="checkbox"> <input type="checkbox"> <input
                type="checkbox"> <input type="checkbox"> <input type="checkbox">
              <!-- <input type="number" name="esconder" min="0" max="6" /> -->
            </label>
          </div>
          <div class="atributo" id="intuicao">
            <h2>Intuição</h2>
            <label><input type="checkbox"> Persuasão <small>(Convencer, Liderar)</small>
              <br>
              <input type="checkbox"> <input type="checkbox"> <input type="checkbox"> <input type="checkbox"> <input
                type="checkbox"> <input type="checkbox"> <input type="checkbox">
              <!-- <input type="number" name="persuasao" min="0" max="6" /> -->
            </label>
            <label><input type="checkbox"> Focar <small>(Inspecionar, Analisar, Lembrar)</small>
              <br>
              <input type="checkbox"> <input type="checkbox"> <input type="checkbox"> <input type="checkbox"> <input
                type="checkbox"> <input type="checkbox"> <input type="checkbox">
              <!-- <input type="number" name="focar" min="0" max="6" /> -->
            </label>
            <label><input type="checkbox"> Sentir <small>(Ocultismo, Canalizar, Revelar)</small>
              <br>
              <input type="checkbox"> <input type="checkbox"> <input type="checkbox"> <input type="checkbox"> <input
                type="checkbox"> <input type="checkbox"> <input type="checkbox">
              <!-- <input type="number" name="sentir" min="0" max="6" /> -->
            </label>
          </div>
        </section>

        <!-- Papel e Especialidade -->
        <section class="papel-especialidade">
          <h3>Habilidades do Papel</h3>
          <textarea name="papelDescricao" rows="6"></textarea>

          <h3>Habilidades da Especialidade</h3>
          <textarea name="especialidade" rows="10"></textarea>
        </section>

        <!-- Marcas, Relacionamentos, Equipamento e Notas -->
        <div class="section marcas">
          <div class="header-black">
            <h2>MARCAS</h2>
          </div>
          <div class="marcas-conteudo">
            <div class="categoria" data-categoria="corpo">
              <h3>CORPO</h3>
              <label class="max-marcas-control">
                Máximo de marcas:
                <input type="number" min="1" max="20" value="3" class="max-marcas-input" />
              </label>
              <ul class="marcas-lista"></ul>
            </div>

            <div class="categoria" data-categoria="mente">
              <h3>MENTE</h3>
              <label class="max-marcas-control">
                Máximo de marcas:
                <input type="number" min="1" max="20" value="3" class="max-marcas-input" />
              </label>
              <ul class="marcas-lista"></ul>
            </div>

            <div class="categoria" data-categoria="sangria">
              <h3>SANGRIA</h3>
              <label class="max-marcas-control">
                Máximo de marcas:
                <input type="number" min="1" max="20" value="3" class="max-marcas-input" />
              </label>
              <ul class="marcas-lista"></ul>
            </div>
          </div>

        </div>

        <div class="subsection relacionamentos">
          <h3>RELACIONAMENTOS</h3>
          <ul class="lista-relacionamento">
            <li><input type="text"></li>
            <li><input type="text"></li>
            <li><input type="text"></li>
            <li><input type="text"></li>
            <li><input type="text"></li>
            <li><input type="text"></li>
            <li><input type="text"></li>
            <li><input type="text"></li>
            <li><input type="text"></li>
            <li><input type="text"></li>
            <li><input type="text"></li>
            <li><input type="text"></li>
            <li><input type="text"></li>
          </ul>
        </div>

        <div class="subsection equipamento">
          <h3>EQUIPAMENTO</h3>
          <p>Durante cada atribuição, escolha até três.</p>
          <ul class="lista-equipamento">
            <li><input type="checkbox"> <input type="text"></li>
            <li><input type="checkbox"> <input type="text"></li>
            <li><input type="checkbox"> <input type="text"></li>
            <li><input type="checkbox"> <input type="text"></li>
            <li><input type="checkbox"> <input type="text"></li>
            <li><input type="checkbox"> <input type="text"></li>
          </ul>
        </div>

        <div class="subsection notas">
          <h3>NOTAS</h3>
          <textarea rows="5" cols="40" placeholder="Escreva suas anotações aqui..."></textarea>
        </div>
        <button type="submit">Salvar Ficha</button>
      </form>
    </header>
  </main>
  <!-- Modal para mostrar resultado do dado -->
  <div id="modalDado" class="modal-dado">
    <div class="modal-content">
      <span id="fecharModal" class="fechar">&times;</span>
      <p id="resultadoDado" class="resultado-dado-text"></p>
    </div>
  </div>


</body>

</html>